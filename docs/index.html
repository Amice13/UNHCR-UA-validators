<html style="overflow: hidden;">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">

    <!-- ✅ CSP allowing JS from CDN and inline module -->
    <meta
      http-equiv="Content-Security-Policy"
      content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com https://cdn.jsdelivr.net;
        style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.bunny.net;
        font-src 'self' https://cdn.jsdelivr.net https://fonts.bunny.net data:;
        img-src 'self' data:;
        connect-src 'self' https://cdn.jsdelivr.net;
        object-src 'none';
        base-uri 'self';
      "
    >
    <!-- ✅ External CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@3.10.0/dist/vuetify.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="https://fonts.bunny.net/css?family=roboto:400,500,700">
    <script src='./scripts/prevent-clickjacking.js'></script>
    <!-- ✅ Import map must appear BEFORE the module -->
    <style id="antiClickjack">
        body{display:none !important;}
    </style>
    <script type="importmap">
      {
        "imports": {
          "vue": "./scripts/vue.esm-browser.js",
          "vuetify": "./scripts/vuetify.esm.js"
        }
      }
    </script>
<!--     <script type="importmap">
      {
        "imports": {
          "vue": "https://cdn.jsdelivr.net/npm/vue@3/dist/vue.esm-browser.js",
          "vuetify": "https://cdn.jsdelivr.net/npm/vuetify@3.10.0/dist/vuetify.esm.js"
        }
      }
    </script> -->
  </head>
  <style>

body {
  overflow-y: scroll;
}

svg {
  width: 160px;
  height: auto;
  color: #FFF;
}
.lds-ring {
  display: inline-block;
  position: relative;
  width: 80px;
  height: 80px;
}
.lds-ring div {
  box-sizing: border-box;
  display: block;
  position: absolute;
  width: 64px;
  height: 64px;
  margin: 8px;
  border: 8px solid #fff;
  border-radius: 50%;
  animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
  border-color: #0072bc transparent transparent transparent;
}
.lds-ring div:nth-child(1) {
  animation-delay: -0.45s;
}
.lds-ring div:nth-child(2) {
  animation-delay: -0.3s;
}
.lds-ring div:nth-child(3) {
  animation-delay: -0.15s;
}
@keyframes lds-ring {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

#inner-splash {
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

.v-list-item-title {
  font-size: 85%;
}

.v-list-item-subtitle {
  font-size: 120%;
}

  </style>
</head>
<body>
  <div id="splash" style="height: 100vh;">
    <div id="inner-splash" style="height: 100vh;">
      <div class="lds-ring"><div></div><div></div><div></div><div></div></div>
    </div>
  </div>
  <div id="app">
    <v-app>
      <v-app-bar app color="white" dark>
        <div class="d-flex align-center">
          <img
            class="mt-2 mb-2 pr-4 ml-4 mr-4"
            src="./logo.svg"
            style="width: 160px; border-right: 1px solid #0072bc;"
          />
        </div>
        <div class="primary--text text-h5 text-primary hidden-sm-and-down">
          {{ t('UNHCR Ukraine data validator') }}
        </div>
        <v-spacer></v-spacer>
        <v-btn
          @click="isBulk = !isBulk"
          color="primary"
          variant="flat"
          depressed
          class="mr-2"
        >{{ t(isBulk ? 'Single' : 'Bulk') }}</v-btn>
        <v-btn
          @click="lang = lang === 'en' ? 'uk' : 'en'"
          class="mr-4"
          variant="outlined"
          color="grey darken-2"
          outlined
          depressed
        >
          {{ lang }}
        </v-btn>
      </v-app-bar>
      <v-main class="main-container" style="margin-top:24px;">
        <v-container v-if="isBulk">
          <v-layout row wrap class="pr-4 pl-4">
            <v-row>
              <v-col cols="12">
                <v-chip
                  v-for="chip in chips"
                  @click="selected = chip"
                  :variant="selected !== chip ? 'outlined' : 'tonal'"
                  :key="chip"
                  class="mr-2"
                  color="primary"
                >{{ t(chip) }}</v-chip>
              </v-col>
              <v-col cols="12">
                <v-textarea
                  v-model="text"
                  outlined
                  hide-details
                />
              </v-col>
              <v-col cols="12" class="text-right">
                <v-btn
                  v-if="text"
                  @click="copyclipboard(text)"
                  variant="text"
                  icon
                  class="mr-2"
                >
                  <v-icon color="grey-darken-1">mdi-content-copy</v-icon>
                </v-btn>
                <v-btn
                  @click="processText"
                  color="primary">{{ t('Process') }}
                </v-btn>
              </v-col>
            </v-row>
          </v-layout>
        </v-container>
        <v-container v-if="!isBulk">
          <v-layout row wrap class="pr-4 pl-4">
            <v-row>
              <v-col md="6" cols="12">
                <v-card>
                  <v-card-title class="primary bg-primary white--text">
                    {{ t('Tax ID validation') }}
                  </v-card-title>
                  <v-card-text class="pt-4">
                    <p class="mb-4">{{ t('Please validate the Tax ID of the focal point before enrollment') }}</p>
                    <v-text-field
                      v-model="ipn"
                      :label="t('Tax ID')"
                      :rules="ipnRules"
                      variant="outlined"
                      clearable
                    ></v-text-field>
                    <h2 v-show="ipnResult">{{ t('Results') }}</h2>
                    <v-list v-if="ipnResult" subheader two-line>
                      <v-list-item
                        :title="t('Identifier')"
                        :subtitle="ipn"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-identifier</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(ipn)" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                      <v-divider inset v-show="ipnResult.result === 'Valid'"></v-divider>

                      <v-list-item
                        :title="t('Gender')"
                        :subtitle="t(ipnResult.gender)"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">{{ ipnResult.gender === 'Male' ? 'mdi-human-male' : 'mdi-human-female' }}</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(t(ipnResult.gender))" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                      <v-divider inset v-show="ipnResult.result === 'Valid'"></v-divider>

                      <v-list-item
                        :title="t('Date of birth')"
                        :subtitle="ipnResult.birthday"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-calendar</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(t(ipnResult.birthday))" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>

                      <v-divider inset></v-divider>

                      <v-list-item
                        :title="t('Age')"
                        :subtitle="ipnResult.age"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-counter</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(t(ipnResult.age))" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>

                      <v-divider inset></v-divider>

                      <v-list-item
                        :class="{
                          'not-valid': ipnResult.result !== 'Valid',
                          'valid': ipnResult.result === 'Valid' && ipnResult.age > 0,
                          'attention': ipnResult.result === 'Valid' && ipnResult.age <= 0                          
                        }"
                        :title="t('Status')"
                        :subtitle="ipnResult.result"
                      >
                        <template v-slot:prepend>
                          <v-avatar
                            color="white"
                          >
                            <v-icon
                              size="large"
                              class="text--darken-2"
                              :class="{
                                'text-red': ipnResult.result !== 'Valid',
                                'text-green': ipnResult.result === 'Valid' && ipnResult.age > 0,
                                'text-yellow darken-2': ipnResult.result === 'Valid' && ipnResult.age <= 0
                              }"
                              color="white"
                            >{{ ipnResult.result === 'Valid' ? 'mdi-check' : 'mdi-close' }}</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(t(ipnResult.result))" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                    </v-list>
                  </v-card-text>
                </v-card>
              </v-col>
              <v-col md="6" cols="12">
                <v-card>
                  <v-card-title class="primary bg-primary white--text">
                    {{ t('Credit card validation') }}
                  </v-card-title>
                  <v-card-text class="pt-4">
                    <p class="mb-4">{{ t('Please validate the credit card number before enrollment') }}</p>
                    <v-text-field
                      v-model="creditCard"
                      :label="t('Credit card number')"
                      :rules="creditCardRules"
                      variant="outlined"
                      clearable
                    ></v-text-field>
                    <h2 v-show="creditCardResult">{{ t('Results') }}</h2>
                    <v-list subheader two-line v-if="creditCardResult">

                      <v-list-item
                        :title="t('Identifier')"
                        :subtitle="creditCardResult.id"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-identifier</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(creditCardResult.id)" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                      <v-divider inset v-show="creditCardResult.result === 'Valid'"></v-divider>

                      <v-list-item
                        v-show="creditCardResult.result === 'Valid'"
                        :title="t('Card type')"
                        :subtitle="creditCardResult.type"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-credit-card</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(creditCardResult.type)" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                      <v-divider inset></v-divider>

                      <v-list-item
                        :class="{
                          'not-valid': creditCardResult.result !== 'Valid',
                          'valid': creditCardResult.result === 'Valid',
                        }"
                        :title="t('Status')"
                        :subtitle="creditCardResult.result"
                      >
                        <template v-slot:prepend>
                          <v-avatar
                            color="white"
                          >
                            <v-icon
                              size="large"
                              class="text--darken-2"
                              :class="{
                                'text-red': creditCardResult.result !== 'Valid',
                                'text-green': creditCardResult.result === 'Valid'
                              }"
                              color="white"
                            >{{ creditCardResult.result === 'Valid' ? 'mdi-check' : 'mdi-close' }}</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(t(creditCardResult.result))" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                    </v-list>
                  </v-card-text>
                </v-card>
              </v-col>
              <v-col md="6" cols="12">
                <v-card>
                  <v-card-title class="primary bg-primary white--text">
                    {{ t('IBAN validation') }}
                  </v-card-title>
                  <v-card-text class="pt-4">
                    <p class="mb-4">{{ t('Please validate the IBAN of the focal point before enrollment') }}</p>
                    <v-text-field
                      v-model="iban"
                      :label="t('IBAN code')"
                      :rules="ibanRules"
                      variant="outlined"
                      clearable
                    ></v-text-field>
                    <h2 v-show="ibanResult">{{ t('Results') }}</h2>
                    <v-list subheader two-line v-if="ibanResult">
                      <v-list-item
                        :title="t('Identifier')"
                        :subtitle="ibanResult.id"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-identifier</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(ibanResult.id)" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                      <v-divider inset v-show="ibanResult.result === 'Valid'"></v-divider>

                      <v-list-item
                        :title="t('Country')"
                        :subtitle="lang === 'en' ? ibanResult.countryEng : ibanResult.country"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-earth</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(lang === 'en' ? ibanResult.countryEng : ibanResult.country)" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                      <v-divider inset v-show="ibanResult.result === 'Valid'"></v-divider>

                      <v-list-item
                        :title="t('Type of account')"
                        :subtitle="ibanResult.personal ? 'Personal account' : 'Not personal account'"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-account</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(ibanResult.personal ? 'Personal account' : 'Not personal account')" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                      <v-divider inset v-show="ibanResult.result === 'Valid'"></v-divider>

                      <v-list-item
                        :title="t('Bank code')"
                        :subtitle="ibanResult.mfo"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-text-box-search-outline</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(ibanResult.mfo)" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                      <v-divider inset v-show="ibanResult.result === 'Valid'"></v-divider>

                      <v-divider inset v-show="ibanResult.result === 'Valid'"></v-divider>

                      <v-list-item
                        v-if="ibanResult.bank"
                        :title="t('Bank name')"
                        :subtitle="lang === 'en' ? translit(ibanResult.bank) : ibanResult.bank"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-bank</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(lang === 'en' ? translit(ibanResult.bank) : ibanResult.bank)" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>

                      <v-divider inset></v-divider>

                      <v-list-item
                        :class="{
                          'not-valid': ibanResult.result !== 'Valid',
                          'valid': ibanResult.result === 'Valid'
                        }"
                        :title="t('Status')"
                        :subtitle="ibanResult.result"
                      >
                        <template v-slot:prepend>
                          <v-avatar
                            color="white"
                          >
                            <v-icon
                              size="large"
                              class="text--darken-2"
                              :class="{
                                'text-red': ibanResult.result !== 'Valid',
                                'text-green': ibanResult.result === 'Valid'
                              }"
                              color="white"
                            >{{ ibanResult.result === 'Valid' ? 'mdi-check' : 'mdi-close' }}</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(t(ibanResult.result))" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                    </v-list>
                  </v-card-text>
                </v-card>
              </v-col>


              <v-col md="6" cols="12">
                <v-card>
                  <v-card-title class="primary bg-primary white--text">
                    {{ t('Transliteration') }}
                  </v-card-title>
                  <v-card-text class="pt-4">
                    <p class="mb-4">{{ t('Please, provide a string in Ukrainian and use proper transliteration') }}</p>
                    <v-text-field
                      v-model="transliteration"
                      :label="t('String in Ukrainian')"
                      :rules="transliterationRules"
                      variant="outlined"
                      clearable
                    ></v-text-field>
                    <h2 v-show="transliterated">{{ t('Results') }}</h2>
                    <v-list subheader tree-line v-show="transliterated">

                      <v-list-item
                        :subtitle="transliterated"
                      >
                        <template v-slot:prepend>
                          <v-avatar color="white">
                            <v-icon size="large" color="grey-darken-1">mdi-bank</v-icon>
                          </v-avatar>
                        </template>
                        <template v-slot:append>
                          <v-btn @click="copyclipboard(transliterated)" variant="text" icon="mdi-content-copy"></v-btn>
                        </template>
                      </v-list-item>
                    </v-list>
                  </v-card-text>
                </v-card>
              </v-col>
            </v-row>
          </v-layout>
        </v-container>
        <v-snackbar v-model="snackbar" :timeout="2000">
          {{ t('Copied to the clipboard') }}
          <template v-slot:action="{ attrs }">
            <v-btn color="blue" text
              v-bind="attrs"
              @click="snackbar = false"
            >
              {{ t('Close') }}
            </v-btn>
          </template>
        </v-snackbar>
      </v-main>
      <v-footer padless class="mt-6">
        <v-col
          class="text-center"
          cols="12"
        >
          {{ new Date().getFullYear() }} - {{ t('UNHCR, developer contact: Kyrylo Zakharov') }} (<a href="mailto:zakharok@unhcr.org">zakharok@unhcr.org</a>)</v-col>
      </v-footer>
    </v-app>
  </div>

  <script type="module" src="./scripts/main.js"></script>
  </body>
</html>